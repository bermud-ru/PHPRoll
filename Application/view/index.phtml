<?php

namespace Application;
if (in_array($_SERVER['REQUEST_METHOD'], array('POST'))) {
    if ($error) $json(array('result'=>'error', 'message'=> $error['message']));
}

$title = 'Simple PHP backend script for RIA (Rich Internet Application) / SPA (Single-page Application) frontend';
$page['GET']['header'][] = <<<EOT
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content="git@github.com:bermud-ru/phproll.git"/>
    <meta name="author" content="Андрей Новиков <andrey@novikov.be>"/>
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/css/index.css" rel="stylesheet" />
    <title>{$title}</title>
    <script id="alert-box" type="text/x-template">
    {% var opt = {error:'ОШИБКА', message: 'spa приложения!'}; for (i in arguments) opt = Object.assign(opt, arguments[i]); %}
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <span class="result">{%=opt.error %}</span> <span class="message">{%=opt.message %}</span>
    </script>
</head>
EOT;
$page['GET']['body'][] = <<<EOT
<body>
<div id="app" role="application">
    <div class="container" role="workspace"></div>
</div>
<div class="alert alert-danger message" style="display: none;"></div>
<div class="b-popup" style="display: none;">
    <div class="b-popup-content"></div>
</div>
<div class="locker spinner" style="display: none;"> </div>
<script type="text/javascript" src="/js/jsroll.min.js" charset="UTF-8"></script>
<script type="text/javascript" src="/js/jsroll.app.js" charset="UTF-8"></script>
</body>
EOT;
$page['GET']['footer'][] = <<<EOT
</html>
EOT;
array_walk_recursive($page[$_SERVER['REQUEST_METHOD']], function($item){ echo $item; });
?>